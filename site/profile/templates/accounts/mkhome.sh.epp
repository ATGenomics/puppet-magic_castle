#!/bin/bash
source /sbin/account_functions.sh

tail -F /var/log/dirsrv/slapd-*/access |
grep --line-buffered -oP 'ADD dn=\"uid=\K([a-z0-9A-Z_]*)(?=,cn=users)' |
while read USERNAME; do
<% if $with_home { -%>
    mkhome $USERNAME
<% } -%>
<% if $with_scratch { -%>
    mkscratch $USERNAME <%= $with_home %>
<% } -%>
done
